{% load static %}
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %} {% endblock %}</title>
  {% block css %} 
  
  {% endblock %}
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
  <style>
        nav{
            background: linear-gradient(90deg, #F3C4FB 0%, #A5F3FC 45%, #D1E8FF 100%);
            border-bottom: 2px solid blue;
        }
        .nav-link{
          color: grey;

        }
        body{
          background-color:azure;
        }
        .close-in{
            border: none;
          background: none;
          font-size: 40px;
        }
        .alert-dismissible .btn-close {
          position: static;
          margin: 0 !important;
          padding: 0 !important;
        }
    </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand fw-bolder text-secondary-emphasis" href="/blog">buyCart</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link fw-semibold {%block home%}{%endblock home%}" aria-current="page" href="/shop">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold {%block about%}{%endblock about%}" href="/shop/about">About Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold {%block tracker%}{%endblock tracker%}" href="/shop/tracker">Tracker</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold {%block contact%}{%endblock contact%}" href="/shop/contact">Contact Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold {%block blog%}{%endblock blog%}" href="/blog">Blog</a>
          </li>
        </ul>
        <form class="d-flex" role="search" method="get" action="/blog/search/">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name="search" id="search"/>
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
        {% if user.is_authenticated %}
        <ul class="navbar-nav mr-2">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Welcome {{request.user}}
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="/blog/logout">Log Out</a>
                    </div>
                </li>
            </ul>
            {% else %}
            <button type="button" class="btn btn-primary mx-2" data-toggle="modal" data-target="#signupModal">
                Sign Up
            </button>
            <button type="button" class="btn btn-primary mr-2" data-toggle="modal" data-target="#loginModal">
                Log In
            </button>
        {%endif%}
      </div>
    </div>
  </nav>
  {% for message in messages %}
    {% if message.tags == "error" %}
        <div class="alert alert-danger alert-dismissible fade show d-flex justify-content-between fixed-top" style="margin-top: 60px!important;" role="alert">
    {% else %}
        <div class="alert alert-{{message.tags}} alert-dismissible fade show d-flex justify-content-between" style="margin-top: 60px!important;" role="alert">
    {% endif %}
          <div class="d-flex justify-content-between align-items-center mx-auto" style="max-width: 500px; width: 100%;">
            <strong>{{message}}</strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        </div>
  {% endfor %}

  <!--sign up Modal -->
    <div class="modal fade" id="signupModal" tabindex="-1" role="dialog" aria-labelledby="signupModal"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header d-flex justify-content-between">
                    <h4 class="modal-title" id="signupModalTitle">Sign Up</h4>
                    <button type="button" class="close close-in" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method='post' action='/blog/signup/'>
                        {% csrf_token %}
                        <div class="form-group mb-2">
                            <label for="username">Username</label>
                            <input type="text" class="form-control" id="username" name="username"
                                placeholder="username (lowercase & alphanumeric)" required>
                        </div>
                        <div class="form-group mb-2">
                            <label for="fname">First Name</label>
                            <input type="text" class="form-control" id="fname" name="fname" placeholder="first name"
                                required>
                        </div>
                        <div class="form-group mb-2">
                            <label for="lname">Last Name</label>
                            <input type="text" class="form-control" id="lname" name="lname" placeholder="last name"
                                required>
                        </div>
                        <div class="form-group mb-2">
                            <label for="email">Email address</label>
                            <input type="email" class="form-control" id="email" name="email"
                                placeholder="name@example.com" required>
                        </div>
                        <div class="form-group mb-2">
                            <label for="pass1">Password</label>
                            <input type="password" class="form-control" id="pass1" name="pass1"
                                placeholder="Select strong password" required>
                            <div class="alert my-2" id="strength" role="alert" style="display: none;">

                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="pass2">Confirm Password</label>
                            <input type="password" class="form-control" id="pass2" name="pass2"
                                placeholder="confirm password" required>
                                <ul style="display: none;" class="my-2" id="confpass">
                                </ul>
                        </div>
                        <button type="button" class="btn btn-secondary" style="cursor: pointer;" data-dismiss="modal" >Close</button>
                        <button type="submit" class="btn btn-primary" style="cursor: pointer;">Register</button>
                    </form>
                </div>
                <div class="modal-footer">

                </div>
            </div>
        </div>
    </div>

    <!--log in Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header d-flex justify-content-between">
                    <h4 class="modal-title" id="loginModalTitle">Log In</h4>
                    <button type="button" class="close close-in" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action='/blog/login/' method='post'>
                        {% csrf_token %}
                        <div class="form-group mb-2">
                            <label for="loginusername">Username</label>
                            <input type="text" class="form-control" id="loginusername" name="loginusername"
                                placeholder="username" required>
                        </div>
                        <div class="form-group mb-2">
                            <label for="pass">Password</label>
                            <input type="password" class="form-control" id="loginpass" name="loginpass"
                                placeholder="Enter Your Pssword" required>
                        </div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Log In</button>
                    </form>
                </div>
                <div class="modal-footer">

                </div>
            </div>
        </div>
    </div>

  {% block body %} {% endblock %}
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
    <script>
        const passInput = document.getElementById('pass1')
        const passInput2 = document.getElementById('pass2')
        const strength = document.getElementById('strength')

        passInput.addEventListener("input", function () {
            const value = passInput.value;
            const onlyLettersLower = /^[a-z]+$/;
            const onlyLettersUpper = /^[A-Z]+$/;
            const onlyNumbers = /^\d+$/;
            const onlySpecial = /^[\W_]+$/;
            const hasLower = /[a-z]/;
            const hasUpper = /[A-Z]/;
            const hasNumber = /\d/;
            const hasSpecial = /[\W_]/;

            if (value.length === 0) {
                strength.style.display = "none";
                strength.textContent = "";
                strength.classList.remove("alert", "alert-danger", "alert-warning", "alert-success");
                return;
            }
            strength.style.display = "block";
            strength.classList.add("alert");
            strength.classList.remove("alert-danger", "alert-warning", "alert-success");

            const hasLowerCase = hasLower.test(value);
            const hasUpperCase = hasUpper.test(value);
            const hasNumeric = hasNumber.test(value);
            const hasSpecialChar = hasSpecial.test(value);
            const charTypeCount = hasLowerCase + hasUpperCase + hasNumeric + hasSpecialChar;

            if (
                onlyLettersLower.test(value) ||
                onlyLettersUpper.test(value) ||
                onlyNumbers.test(value) ||
                onlySpecial.test(value)
            ) {
                strength.textContent = "Weak Password";
                strength.classList.add("alert-danger");
            }
            else if (hasLowerCase && hasUpperCase && hasNumeric && hasSpecialChar) {
                strength.textContent = "Strong Password";
                strength.classList.add("alert-success");
            }
            else if (charTypeCount >= 2) {
                strength.textContent = "Medium Password";
                strength.classList.add("alert-warning");
            }
            else {
                strength.style.display = "none";
                strength.textContent = "";
                strength.classList.remove("alert", "alert-danger", "alert-warning", "alert-success");
            }
        });
        const confpass=document.getElementById('confpass')

        passInput2.addEventListener("input", function () {
            if (passInput2.value.length===0) {
                confpass.style.display = "none";
                confpass.innerHTML = "";
                return;
            }
            confpass.style.display = "block";
            if (passInput2.value !== passInput.value) {
                confpass.style.color="red"
                confpass.innerHTML="<li><b>Password Is Not Matching</b></li>"
            }
            else{
                confpass.style.display = "none";
                confpass.innerHTML = "";
            }    
        })
    </script>
    
    {% block js %} {% endblock %}
</body>

</html>